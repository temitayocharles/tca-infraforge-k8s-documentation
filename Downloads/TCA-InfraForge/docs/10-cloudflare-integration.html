<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCA InfraForge Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            padding: 30px;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .pagination {
            justify-content: center;
        }

        .page-link {
            color: #667eea;
        }

        .page-link:hover {
            color: #764ba2;
        }

        .btn-prev,
        .btn-next {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
        }

        .btn-prev:hover,
        .btn-next:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            color: white;
        }

        h1,
        h2,
        h3 {
            color: #333;
        }

        code {
            background: #f8f9fa;
            padding: 2px 4px;
            border-radius: 4px;
        }

        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .emoji {
            font-size: 1.2em;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        body.dark-mode .container {
            background: #2c3e50;
            color: #ecf0f1;
        }

        body.dark-mode .navbar {
            background: rgba(44, 62, 80, 0.9);
        }

        body.dark-mode h1, body.dark-mode h2, body.dark-mode h3 {
            color: #ecf0f1;
        }

        body.dark-mode code {
            background: #34495e;
            color: #ecf0f1;
        }

        body.dark-mode pre {
            background: #34495e;
            color: #ecf0f1;
        }

        body.dark-mode table th {
            background-color: #34495e;
        }

        body.dark-mode table td {
            border-color: #7f8c8d;
        }

        .copy-btn {
            opacity: 0.7;
        }

        .copy-btn:hover {
            opacity: 1;
        }

        .content {
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">TCA InfraForge Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Pages</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="01-executive-summary.html">1. Executive Summary</a></li>
                            <li><a class="dropdown-item" href="02-architecture-overview.html">2. Architecture
                                    Overview</a></li>
                            <li><a class="dropdown-item" href="03-quick-start-guide.html">3. Quick Start Guide</a></li>
                            <li><a class="dropdown-item" href="04-automated-deployment.html">4. Automated Deployment</a>
                            </li>
                            <li><a class="dropdown-item" href="05-container-kubernetes.html">5. Container &
                                    <img src="https://kubernetes.io/images/favicon.png" alt="Kubernetes"
                                        style="height:1.2em; vertical-align:middle;"> Kubernetes</a></li>
                            <li><a class="dropdown-item" href="06-networking-ingress.html">6. Networking & Ingress</a>
                            </li>
                            <li><a class="dropdown-item" href="07-monitoring-observability.html">7. Monitoring &
                                    Observability</a></li>
                            <li><a class="dropdown-item" href="08-enterprise-applications.html">8. Enterprise
                                    Applications</a></li>
                            <li><a class="dropdown-item" href="09-security-compliance.html">9. Security & Compliance</a>
                            </li>
                            <li><a class="dropdown-item" href="10-cloudflare-integration.html">10. Cloudflare
                                    Integration</a></li>
                            <li><a class="dropdown-item" href="11-performance-optimization.html">11. Performance
                                    Optimization</a></li>
                            <li><a class="dropdown-item" href="12-ci-cd-pipeline.html">12. CI/CD Pipeline</a></li>
                            <li><a class="dropdown-item" href="13-contributing-development.html">13. Contributing &
                                    Development</a></li>
                        </ul>
                    </li>
                </ul>
                <form class="d-flex me-2">
                    <input class="form-control me-2" type="search" placeholder="Search headings..." id="searchInput">
                </form>
                <div class="d-flex">
                    <button class="btn btn-outline-secondary me-2" id="darkModeToggle">
                        <i class="fas fa-moon"></i> Dark
                    </button>
                    <button class="btn btn-prev me-2" id="prevBtn">Previous</button>
                    <button class="btn btn-next" id="nextBtn">Next</button>
                </div>
            </div>
        </div>
    </nav>

    <div id="progressBar" style="height: 4px; background: linear-gradient(45deg, #667eea, #764ba2); width: 0%; position: fixed; top: 0; left: 0; z-index: 1000;"></div>

    <div class="container">
        <nav aria-label="Page navigation">
            <ul class="pagination" id="pagination">
                <!-- Pagination will be generated by JS -->
            </ul>
        </nav>

        <div class="content">
            <h1 id="chapter-10-cloudflare-integration">‚òÅÔ∏è Chapter 10: Cloudflare Integration</h1>
<h2 id="learning-objectives">üéØ Learning Objectives</h2>
<p>By the end of this chapter, you‚Äôll understand: - How to set up secure external access with Cloudflare Tunnel - DNS management and SSL certificate automation - Performance optimization and security enhancements - Monitoring and troubleshooting tunnel connections</p>
<p><strong>‚è±Ô∏è Time to Complete:</strong> 25-30 minutes<br />
<strong>üí° Difficulty:</strong> Intermediate<br />
<strong>üéØ Prerequisites:</strong> Basic understanding of networking and DNS</p>
<hr />
<h2 id="cloudflare-integration-overview">üåê Cloudflare Integration Overview</h2>
<p>TCA InfraForge integrates with <strong>Cloudflare</strong> to provide <strong>secure, fast, and reliable external access</strong> to your platform without exposing any ports on your local network. This creates a <strong>secure tunnel</strong> between your local environment and Cloudflare‚Äôs global network.</p>
<h3 id="why-cloudflare-integration">Why Cloudflare Integration?</h3>
<ul>
<li><strong>üîí Zero Ports Exposed:</strong> No need to open firewall ports</li>
<li><strong>‚ö° Global Performance:</strong> CDN-accelerated access worldwide</li>
<li><strong>üõ°Ô∏è Enterprise Security:</strong> Web Application Firewall (WAF) protection</li>
<li><strong>üîê Automatic SSL:</strong> Free SSL certificates with auto-renewal</li>
<li><strong>üìä Advanced Analytics:</strong> Detailed traffic and performance insights</li>
<li><strong>üöÄ Load Balancing:</strong> Distribute traffic across multiple instances</li>
</ul>
<p><strong>Real-world analogy:</strong> Like having a secure, high-speed highway connecting your private driveway to the global internet, with toll booths (security) and rest stops (CDN caching) along the way.</p>
<hr />
<h2 id="cloudflare-architecture">üèóÔ∏è Cloudflare Architecture</h2>
<h3 id="integration-components">Integration Components</h3>
<pre class="mermaid"><code>graph TB
    subgraph &quot;Local Environment&quot;
        TCA_PLATFORM[TCA InfraForge&lt;br/&gt;Kubernetes Platform]
        CLOUDFLARED[‚òÅÔ∏è cloudflared&lt;br/&gt;Tunnel Client]
        LOCAL_SERVICES[üîå Local Services&lt;br/&gt;API, Web, Monitoring]
    end

    subgraph &quot;Cloudflare Network&quot;
        TUNNEL[üåê Cloudflare Tunnel&lt;br/&gt;Secure Connection]
        WAF[üõ°Ô∏è Web Application Firewall&lt;br/&gt;Security Layer]
        CDN[‚ö° Content Delivery Network&lt;br/&gt;Performance Layer]
        LOAD_BALANCER[‚öñÔ∏è Load Balancer&lt;br/&gt;Traffic Distribution]
    end

    subgraph &quot;External Access&quot;
        USERS[üë• End Users&lt;br/&gt;Worldwide]
        DNS[üîç DNS Resolution&lt;br/&gt;your-domain.com]
        SSL[üîí SSL Termination&lt;br/&gt;Automatic Certificates]
    end

    TCA_PLATFORM --&gt; CLOUDFLARED
    CLOUDFLARED --&gt; TUNNEL
    TUNNEL --&gt; WAF
    WAF --&gt; CDN
    CDN --&gt; LOAD_BALANCER
    LOAD_BALANCER --&gt; SSL
    USERS --&gt; DNS
    DNS --&gt; SSL
    SSL --&gt; LOAD_BALANCER</code></pre>
<h3 id="key-components-explained">Key Components Explained</h3>
<h4 id="cloudflare-tunnel-cloudflared">Cloudflare Tunnel (cloudflared)</h4>
<ul>
<li><strong>üîê Secure Connection:</strong> Encrypted tunnel from your local machine to Cloudflare</li>
<li><strong>üöÄ High Performance:</strong> Optimized for low latency and high throughput</li>
<li><strong>üîÑ Auto-Reconnection:</strong> Automatically reconnects if connection drops</li>
<li><strong>üìä Built-in Monitoring:</strong> Connection health and performance metrics</li>
</ul>
<h4 id="web-application-firewall-waf">Web Application Firewall (WAF)</h4>
<ul>
<li><strong>üõ°Ô∏è Attack Prevention:</strong> Blocks common web attacks (SQL injection, XSS, etc.)</li>
<li><strong>üìè Rate Limiting:</strong> Prevents DDoS attacks and abuse</li>
<li><strong>ü§ñ Bot Management:</strong> Distinguishes between human users and bots</li>
<li><strong>üìä Threat Intelligence:</strong> Uses global threat data for protection</li>
</ul>
<h4 id="content-delivery-network-cdn">Content Delivery Network (CDN)</h4>
<ul>
<li><strong>‚ö° Performance:</strong> Caches content at edge locations worldwide</li>
<li><strong>üåê Global Reach:</strong> 200+ data centers for fast content delivery</li>
<li><strong>üìà Auto-Optimization:</strong> Automatically optimizes images and content</li>
<li><strong>üîÑ Dynamic Content:</strong> Supports dynamic applications with caching rules</li>
</ul>
<hr />
<h2 id="setting-up-cloudflare-tunnel">üöÄ Setting Up Cloudflare Tunnel</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>‚úÖ <strong>Cloudflare Account:</strong> Free account at cloudflare.com</li>
<li>‚úÖ <strong>Domain Name:</strong> Registered domain (or use Cloudflare‚Äôs free subdomain)</li>
<li>‚úÖ <strong>TCA InfraForge:</strong> Platform deployed and running</li>
<li>‚úÖ <strong>Network Access:</strong> Outbound HTTPS access (port 443)</li>
</ul>
<h3 id="step-1-install-cloudflared">Step 1: Install cloudflared</h3>
<h4 id="macos-installation">macOS Installation</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Homebrew (recommended)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install cloudflared</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download directly</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-L</span> https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-darwin-amd64.tgz <span class="kw">|</span> <span class="fu">tar</span> xz</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv cloudflared /usr/local/bin/</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify installation</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> version</span></code></pre></div>
<h4 id="linux-installation">Linux Installation</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using package manager (Ubuntu/Debian)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-L</span> https://pkg.cloudflare.com/cloudflare-main.gpg <span class="kw">|</span> <span class="fu">sudo</span> tee /usr/share/keyrings/cloudflare-archive-keyring.gpg <span class="op">&gt;</span>/dev/null</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;deb [signed-by=/usr/share/keyrings/cloudflare-archive-keyring.gpg] https://pkg.cloudflare.com/cloudflared jammy main&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee /etc/apt/sources.list.d/cloudflared.list</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt-get install cloudflared</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Or download directly</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> +x cloudflared-linux-amd64</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv cloudflared-linux-amd64 /usr/local/bin/cloudflared</span></code></pre></div>
<h3 id="step-2-authenticate-with-cloudflare">Step 2: Authenticate with Cloudflare</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Login to Cloudflare (opens browser)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel login</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This will:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Open your browser to cloudflare.com</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ask you to select your domain</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create a certificate for authentication</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Store credentials in ~/.cloudflared/cert.pem</span></span></code></pre></div>
<h3 id="step-3-create-your-tunnel">Step 3: Create Your Tunnel</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new tunnel</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create tca-infraforge-tunnel</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List your tunnels</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel list</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ID                                     NAME                   CREATED              CONNECTIONS</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 12345678-1234-1234-1234-123456789012   tca-infraforge-tunnel  2024-12-01 10:00:00  0</span></span></code></pre></div>
<h3 id="step-4-configure-tunnel-routes">Step 4: Configure Tunnel Routes</h3>
<p>Create a configuration file for your tunnel:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create config directory</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.cloudflared</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tunnel configuration</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span> ~/.cloudflared/config.yaml <span class="op">&lt;&lt; EOF</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st">tunnel: tca-infraforge-tunnel</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">credentials-file: ~/.cloudflared/tunnel.json</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="st">ingress:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st">  # TCA InfraForge main dashboard</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st">  - hostname: tca.yourdomain.com</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="st">    service: https://localhost:8443</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="st">    originRequest:</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">      noTLSVerify: true</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="st">  # Grafana monitoring</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="st">  - hostname: grafana.yourdomain.com</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="st">    service: https://localhost:3000</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st">    originRequest:</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="st">      noTLSVerify: true</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">  # Vault secrets management</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">  - hostname: vault.yourdomain.com</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">    service: https://localhost:8200</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="st">    originRequest:</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="st">      noTLSVerify: true</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="st">  # API server</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="st">  - hostname: api.yourdomain.com</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="st">    service: https://localhost:8080</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="st">    originRequest:</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="st">      noTLSVerify: true</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="st">  # Catch-all rule (must be last)</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="st">  - service: http_status:404</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span></code></pre></div>
<h3 id="step-5-configure-dns-records">Step 5: Configure DNS Records</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get your tunnel ID</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel list</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DNS records for each hostname</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In Cloudflare dashboard, go to DNS ‚Üí Records</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add CNAME records:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tca.yourdomain.com     CNAME   your-tunnel-id.cfargotunnel.com</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># grafana.yourdomain.com CNAME   your-tunnel-id.cfargotunnel.com</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># vault.yourdomain.com   CNAME   your-tunnel-id.cfargotunnel.com</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># api.yourdomain.com     CNAME   your-tunnel-id.cfargotunnel.com</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use cloudflared command:</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel route dns tca-infraforge-tunnel tca.yourdomain.com</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel route dns tca-infraforge-tunnel grafana.yourdomain.com</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel route dns tca-infraforge-tunnel vault.yourdomain.com</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel route dns tca-infraforge-tunnel api.yourdomain.com</span></code></pre></div>
<h3 id="step-6-start-the-tunnel">Step 6: Start the Tunnel</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start tunnel in foreground (for testing)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel run tca-infraforge-tunnel</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Start tunnel in background (production)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel run <span class="at">--detach</span> tca-infraforge-tunnel</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check tunnel status</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel list</span></code></pre></div>
<h3 id="step-7-test-your-setup">Step 7: Test Your Setup</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test main dashboard</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://tca.yourdomain.com</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Grafana</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://grafana.yourdomain.com</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Test API</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://api.yourdomain.com</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check tunnel logs</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel logs tca-infraforge-tunnel</span></code></pre></div>
<hr />
<h2 id="advanced-configuration">üîß Advanced Configuration</h2>
<h3 id="load-balancing-multiple-instances">Load Balancing Multiple Instances</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># config.yaml for load balancing</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tunnel</span><span class="kw">:</span><span class="at"> tca-infraforge-tunnel</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">credentials-file</span><span class="kw">:</span><span class="at"> ~/.cloudflared/tunnel.json</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ingress</span><span class="kw">:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">  # Load balance across multiple local instances</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> app.yourdomain.com</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> https://localhost:8080</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">originRequest</span><span class="kw">:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">noTLSVerify</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">loadBalancer</span><span class="kw">:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">defaultPolicy</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;round_robin&quot;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> app.yourdomain.com</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> https://localhost:8081</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">originRequest</span><span class="kw">:</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">noTLSVerify</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> app.yourdomain.com</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> https://localhost:8082</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">originRequest</span><span class="kw">:</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">noTLSVerify</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> http_status:404</span></span></code></pre></div>
<h3 id="custom-security-headers">Custom Security Headers</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced security configuration</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ingress</span><span class="kw">:</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> secure.yourdomain.com</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> https://localhost:8443</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">originRequest</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">noTLSVerify</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">      # Add security headers</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">setHostHeader</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">      # Custom headers for security</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">headers</span><span class="kw">:</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;X-Frame-Options&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;DENY&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;X-Content-Type-Options&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;nosniff&quot;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Referrer-Policy&quot;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;strict-origin-when-cross-origin&quot;</span></span></code></pre></div>
<h3 id="performance-optimization">Performance Optimization</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance-optimized configuration</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ingress</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> fast.yourdomain.com</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> https://localhost:3000</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">originRequest</span><span class="kw">:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">noTLSVerify</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">      # Connection pooling</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">keepAliveConnections</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">keepAliveTimeout</span><span class="kw">:</span><span class="at"> 300s</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">      # Compression</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">compressionQuality</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">      # HTTP/2 support</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">http2Origin</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<hr />
<h2 id="security-features">üõ°Ô∏è Security Features</h2>
<h3 id="web-application-firewall-waf-1">Web Application Firewall (WAF)</h3>
<h4 id="enable-waf-protection">Enable WAF Protection</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In Cloudflare dashboard:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Go to Security ‚Üí WAF</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Enable &quot;Bot Fight Mode&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Configure rate limiting rules</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Set up custom firewall rules</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example firewall rule (block SQL injection)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Field: URI Path</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Operator: contains</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Value: SELECT|UNION|INSERT|DELETE</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Action: Block</span></span></code></pre></div>
<h4 id="rate-limiting">Rate Limiting</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure rate limiting in Cloudflare dashboard:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Security ‚Üí WAF ‚Üí Rate limiting</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: API rate limiting</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule name: API Protection</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># URL pattern: /api/*</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Threshold: 100 requests per minute</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Action: Block with 429 response</span></span></code></pre></div>
<h3 id="ssltls-configuration">SSL/TLS Configuration</h3>
<h4 id="automatic-ssl-setup">Automatic SSL Setup</h4>
<p>Cloudflare automatically provides SSL certificates for your domains:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check SSL status</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://tca.yourdomain.com</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected: HTTP/2 200 with proper SSL headers</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - server: cloudflare</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - cf-ray: [ray-id]</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - cf-cache-status: DYNAMIC</span></span></code></pre></div>
<h4 id="custom-ssl-certificates">Custom SSL Certificates</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload custom certificate (if needed)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In Cloudflare dashboard:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SSL/TLS ‚Üí Edge Certificates ‚Üí Upload Custom Certificate</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use ACME for automatic renewal</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ex">certbot</span> certonly <span class="at">--manual</span> <span class="at">--preferred-challenges</span> dns <span class="at">-d</span> yourdomain.com</span></code></pre></div>
<hr />
<h2 id="monitoring-analytics">üìä Monitoring &amp; Analytics</h2>
<h3 id="cloudflare-analytics-dashboard">Cloudflare Analytics Dashboard</h3>
<h4 id="access-analytics">Access Analytics</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open Cloudflare dashboard</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">open</span> https://dash.cloudflare.com</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Navigate to your domain</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Analytics ‚Üí Traffic, Security, Performance</span></span></code></pre></div>
<h4 id="key-metrics-to-monitor">Key Metrics to Monitor</h4>
<ul>
<li><strong>üåê Traffic Analytics:</strong> Requests, bandwidth, response times</li>
<li><strong>üõ°Ô∏è Security Events:</strong> Blocked attacks, threats detected</li>
<li><strong>‚ö° Performance:</strong> Cache hit rates, origin response times</li>
<li><strong>üìç Geographic Data:</strong> Traffic sources by country/region</li>
<li><strong>üîç Top Paths:</strong> Most requested URLs and APIs</li>
</ul>
<h3 id="tunnel-monitoring">Tunnel Monitoring</h3>
<h4 id="check-tunnel-health">Check Tunnel Health</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View tunnel status</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel list</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check connection details</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel info tca-infraforge-tunnel</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View real-time logs</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel logs tca-infraforge-tunnel</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor tunnel metrics</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> http://localhost:8080/metrics  <span class="co"># If metrics enabled</span></span></code></pre></div>
<h4 id="performance-metrics">Performance Metrics</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor tunnel performance</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel stats tca-infraforge-tunnel</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected metrics:</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Connection uptime</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Data transferred</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Response times</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Error rates</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - Connection stability</span></span></code></pre></div>
<hr />
<h2 id="troubleshooting-common-issues">üîß Troubleshooting Common Issues</h2>
<h3 id="issue-tunnel-wont-start">Issue: Tunnel Won‚Äôt Start</h3>
<pre><code>‚ùå Error: Failed to start tunnel
‚úÖ Solution: Check authentication
   cloudflared tunnel login
   Verify credentials file exists: ~/.cloudflared/cert.pem
   Check tunnel name spelling</code></pre>
<h3 id="issue-dns-resolution-fails">Issue: DNS Resolution Fails</h3>
<pre><code>‚ùå Error: DNS_PROBE_FINISHED_NXDOMAIN
‚úÖ Solution: Verify DNS records
   dig tca.yourdomain.com
   Check CNAME points to: [tunnel-id].cfargotunnel.com
   Wait for DNS propagation (can take 5-15 minutes)</code></pre>
<h3 id="issue-connection-refused">Issue: Connection Refused</h3>
<pre><code>‚ùå Error: Connection refused
‚úÖ Solution: Check local services
   curl http://localhost:8443  # Should work locally
   Verify TCA InfraForge is running
   Check firewall settings
   Ensure services are bound to correct interfaces</code></pre>
<h3 id="issue-ssl-certificate-errors">Issue: SSL Certificate Errors</h3>
<pre><code>‚ùå Error: SSL certificate problem
‚úÖ Solution: Configure origin certificates
   In config.yaml, add: originRequest.noTLSVerify: true
   Or install proper SSL certificates on local services
   Check certificate validity dates</code></pre>
<h3 id="issue-slow-performance">Issue: Slow Performance</h3>
<pre><code>‚ùå Error: High latency or slow responses
‚úÖ Solution: Optimize configuration
   Enable HTTP/2: originRequest.http2Origin: true
   Adjust connection pooling settings
   Check Cloudflare data center proximity
   Review local network bandwidth</code></pre>
<h3 id="issue-tunnel-disconnects-frequently">Issue: Tunnel Disconnects Frequently</h3>
<pre><code>‚ùå Error: Tunnel keeps disconnecting
‚úÖ Solution: Improve stability
   Check internet connection stability
   Update cloudflared to latest version
   Configure reconnection settings
   Monitor for network interruptions</code></pre>
<hr />
<h2 id="advanced-features">üöÄ Advanced Features</h2>
<h3 id="multiple-tunnel-management">Multiple Tunnel Management</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create multiple tunnels for different environments</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create production-tunnel</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create staging-tunnel</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create development-tunnel</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Run multiple tunnels simultaneously</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel run production-tunnel <span class="kw">&amp;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel run staging-tunnel <span class="kw">&amp;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel run development-tunnel <span class="kw">&amp;</span></span></code></pre></div>
<h3 id="automated-deployment">Automated Deployment</h3>
<h4 id="systemd-service-linux">Systemd Service (Linux)</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create systemd service</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tee /etc/systemd/system/cloudflared.service <span class="op">&gt;</span> /dev/null <span class="op">&lt;&lt;EOF</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">[Unit]</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">Description=Cloudflare Tunnel</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">After=network.target</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">[Service]</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">Type=simple</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">User=cloudflared</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="st">Group=cloudflared</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">ExecStart=/usr/local/bin/cloudflared tunnel run tca-infraforge-tunnel</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="st">Restart=always</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="st">RestartSec=5</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="st">[Install]</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Enable and start service</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable cloudflared</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl start cloudflared</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status cloudflared</span></code></pre></div>
<h4 id="launchdaemon-macos">LaunchDaemon (macOS)</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create launch daemon</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tee /Library/LaunchDaemons/com.cloudflare.cloudflared.plist <span class="op">&gt;</span> /dev/null <span class="op">&lt;&lt;EOF</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;plist version=&quot;1.0&quot;&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;dict&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;Label&lt;/key&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;string&gt;com.cloudflare.cloudflared&lt;/string&gt;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;ProgramArguments&lt;/key&gt;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;array&gt;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;string&gt;/usr/local/bin/cloudflared&lt;/string&gt;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;string&gt;tunnel&lt;/string&gt;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;string&gt;run&lt;/string&gt;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;string&gt;tca-infraforge-tunnel&lt;/string&gt;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/array&gt;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;RunAtLoad&lt;/key&gt;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;true/&gt;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;KeepAlive&lt;/key&gt;</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;true/&gt;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;StandardErrorPath&lt;/key&gt;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;string&gt;/var/log/cloudflared.log&lt;/string&gt;</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;key&gt;StandardOutPath&lt;/key&gt;</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;string&gt;/var/log/cloudflared.log&lt;/string&gt;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/dict&gt;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/plist&gt;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and start service</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> launchctl load /Library/LaunchDaemons/com.cloudflare.cloudflared.plist</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> launchctl start com.cloudflare.cloudflared</span></code></pre></div>
<h3 id="backup-and-failover">Backup and Failover</h3>
<h4 id="tunnel-redundancy">Tunnel Redundancy</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create backup tunnel</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create tca-backup-tunnel</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure DNS with multiple records</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Primary: tca.yourdomain.com CNAME primary-tunnel.cfargotunnel.com</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Backup:  tca.yourdomain.com CNAME backup-tunnel.cfargotunnel.com</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Cloudflare load balancing for automatic failover</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Traffic Management ‚Üí Load Balancing ‚Üí Create Load Balancer</span></span></code></pre></div>
<hr />
<h2 id="best-practices">üìã Best Practices</h2>
<h3 id="security-best-practices">Security Best Practices</h3>
<ul>
<li><strong>üîê Use Strong Authentication:</strong> Enable MFA for Cloudflare account</li>
<li><strong>üõ°Ô∏è Enable WAF:</strong> Configure appropriate security rules</li>
<li><strong>üìú Audit Logs:</strong> Regularly review access logs</li>
<li><strong>üîÑ Rotate Credentials:</strong> Periodically update tunnel credentials</li>
<li><strong>üìè Rate Limiting:</strong> Protect against abuse and DDoS</li>
</ul>
<h3 id="performance-best-practices">Performance Best Practices</h3>
<ul>
<li><strong>üåê Choose Closest Data Center:</strong> Select Cloudflare data center geographically close to your users</li>
<li><strong>‚ö° Enable Caching:</strong> Configure appropriate caching rules for static content</li>
<li><strong>üîÑ HTTP/2:</strong> Enable HTTP/2 for better performance</li>
<li><strong>üìä Monitor Metrics:</strong> Regularly review performance analytics</li>
<li><strong>üîß Optimize Origin:</strong> Ensure local services are optimized</li>
</ul>
<h3 id="operational-best-practices">Operational Best Practices</h3>
<ul>
<li><strong>üìã Documentation:</strong> Document your tunnel configuration and DNS setup</li>
<li><strong>üîÑ Backup Configuration:</strong> Keep backups of config files and credentials</li>
<li><strong>üìä Monitoring:</strong> Set up alerts for tunnel health and performance</li>
<li><strong>üîß Regular Updates:</strong> Keep cloudflared updated to latest version</li>
<li><strong>üë• Team Access:</strong> Configure appropriate team permissions in Cloudflare</li>
</ul>
<hr />
<h2 id="summary">üìã Summary</h2>
<p>Cloudflare integration provides <strong>secure, high-performance external access</strong> to your TCA InfraForge platform with:</p>
<ul>
<li><strong>üîí Zero-Trust Security:</strong> No ports exposed, enterprise-grade protection</li>
<li><strong>‚ö° Global Performance:</strong> CDN acceleration and worldwide distribution</li>
<li><strong>üõ°Ô∏è Advanced Security:</strong> WAF, DDoS protection, and bot management</li>
<li><strong>üîê Automatic SSL:</strong> Free certificates with auto-renewal</li>
<li><strong>üìä Complete Analytics:</strong> Detailed insights into traffic and performance</li>
<li><strong>üöÄ Easy Setup:</strong> Simple configuration with powerful features</li>
</ul>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol type="1">
<li><strong>Secure by Default:</strong> No local ports exposed to the internet</li>
<li><strong>Performance Optimized:</strong> Global CDN with automatic optimization</li>
<li><strong>Enterprise Security:</strong> Advanced protection against modern threats</li>
<li><strong>Simple Management:</strong> Easy setup with powerful configuration options</li>
<li><strong>Complete Visibility:</strong> Detailed analytics and monitoring capabilities</li>
</ol>
<hr />
<h2 id="whats-next">üéØ What‚Äôs Next?</h2>
<p>Now that you have external access set up, you‚Äôre ready to:</p>
<ol type="1">
<li><strong><a href="./11-performance-optimization.md">üõ†Ô∏è Advanced Configuration</a></strong> - Fine-tune performance and scaling</li>
<li><strong><a href="./12-ci-cd-pipeline.md">‚öôÔ∏è CI/CD Pipeline</a></strong> - Implement automated deployment pipelines</li>
<li><strong><a href="./13-contributing-development.md">ü§ù Contributing &amp; Development</a></strong> - Learn about extending the platform</li>
</ol>
<p><strong>üí° Pro Tip:</strong> Cloudflare tunnels are extremely reliable and secure. Once set up, they require minimal maintenance and provide enterprise-grade connectivity!</p>
<hr />
<p><em>Ready to optimize your platform‚Äôs performance? Let‚Äôs move to the Advanced Configuration chapter to fine-tune your TCA InfraForge deployment!</em> ‚ö°</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });

        // Add copy buttons to code blocks
        document.querySelectorAll('pre').forEach(pre => {
            const button = document.createElement('button');
            button.className = 'btn btn-sm btn-outline-primary copy-btn';
            button.innerHTML = '<i class="fas fa-copy"></i>';
            button.style.position = 'absolute';
            button.style.top = '10px';
            button.style.right = '10px';
            pre.style.position = 'relative';
            pre.appendChild(button);
            button.addEventListener('click', () => {
                const code = pre.querySelector('code') ? pre.querySelector('code').textContent : pre.textContent;
                navigator.clipboard.writeText(code).then(() => {
                    button.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => button.innerHTML = '<i class="fas fa-copy"></i>', 2000);
                });
            });
        });

        // Dark mode toggle
        const darkModeToggle = document.getElementById('darkModeToggle');
        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const icon = darkModeToggle.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> Light';
                localStorage.setItem('darkMode', 'enabled');
            } else {
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark';
                localStorage.setItem('darkMode', 'disabled');
            }
        });

        // Load dark mode preference
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> Light';
        }

        // Reading progress
        window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.offsetHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            document.getElementById('progressBar').style.width = scrollPercent + '%';
        });

        // Back to top
        const backToTopBtn = document.getElementById('backToTop');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.style.display = 'block';
            } else {
                backToTopBtn.style.display = 'none';
            }
        });
        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            let found = false;
            headings.forEach(h => {
                if (!found && h.textContent.toLowerCase().includes(query)) {
                    h.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    found = true;
                }
            });
        });

        // Get current page number from filename
        const currentPath = window.location.pathname;
        const fileName = currentPath.split('/').pop();

        const pageFiles = [
            '01-executive-summary.html',
            '02-architecture-overview.html',
            '03-quick-start-guide.html',
            '04-automated-deployment.html',
            '05-container-kubernetes.html',
            '06-networking-ingress.html',
            '07-monitoring-observability.html',
            '08-enterprise-applications.html',
            '09-security-compliance.html',
            '10-cloudflare-integration.html',
            '10-troubleshooting-guide.html',
            '11-performance-optimization.html',
            '11-troubleshooting-guide.html',
            '12-ci-cd-pipeline.html',
            '13-contributing-development.html',
            'ABOUT.html',
            'ADVANCED-TOOLS-INTEGRATION-REPORT.html',
            'APPLE-SILICON-INTEGRATION.html',
            'BOOK.html',
            'CLOUDFLARE-DNS-CLI-SETUP.html',
            'CONSOLIDATION-COMPLETE.html',
            'ENHANCEMENT-DOCUMENTATION.html',
            'GHCR-SETUP-GUIDE.html',
            'INDEX.html',
            'KUBERNETES-TROUBLESHOOTING.html',
            'MAC-MINI-QUICKSTART.html',
            'README.html',
            'SCRIPT-SECURITY-AUDIT.html',
            'SECURITY-SETUP-GUIDE.html'
        ];

        const pageTitles = pageFiles.map(file => file.replace('.html', '').replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()));

        let currentPage = pageFiles.indexOf(fileName) + 1;
        if (currentPage === 0) currentPage = 1; // for index.html or others

        const totalPages = pageFiles.length;

        // Generate pagination
        const pagination = document.getElementById('pagination');
        for (let i = 1; i <= totalPages; i++) {
            const li = document.createElement('li');
            li.className = 'page-item' + (i === currentPage ? ' active' : '');
            const a = document.createElement('a');
            a.className = 'page-link';
            a.href = pageFiles[i - 1];
            a.textContent = i;
            li.appendChild(a);
            pagination.appendChild(li);
        }

        // Update dropdown
        const dropdown = document.querySelector('.dropdown-menu');
        dropdown.innerHTML = '';
        pageFiles.forEach((file, index) => {
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.className = 'dropdown-item';
            a.href = file;
            a.textContent = `${index + 1}. ${pageTitles[index]}`;
            li.appendChild(a);
            dropdown.appendChild(li);
        });

        // Prev/Next buttons
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        if (currentPage > 1) {
            prevBtn.onclick = () => window.location.href = pageFiles[currentPage - 2];
        } else {
            prevBtn.disabled = true;
        }

        if (currentPage < totalPages) {
            nextBtn.onclick = () => window.location.href = pageFiles[currentPage];
        } else {
            nextBtn.disabled = true;
        }
    </script>
</body>

</html>
<button id="backToTop" class="btn btn-primary" style="position: fixed; bottom: 20px; right: 20px; display: none; z-index: 1001;"><i class="fas fa-arrow-up"></i></button>